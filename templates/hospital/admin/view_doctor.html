{% extends 'hospital/admin/base.html' %}
{% load static %}
{% block content %}
<style>
  .section-header {
    font-family: 'Playfair Display', serif !important;
    color: #1a1a2e;
    font-weight: 700;
    margin-bottom: 25px;
    padding-bottom: 10px;
    border-bottom: 2px solid #c9a84c;
  }
  .table { border-radius: 8px; overflow: hidden; }
  .table thead th { background: linear-gradient(135deg, #1a1a2e, #0f3460); color: #c9a84c; border: none; font-weight: 600; font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px; }
  .table tbody tr:hover { background-color: #f8f6f2; }
  .table td { vertical-align: middle; }
  .btn-edit { background: linear-gradient(135deg, #1a1a2e, #0f3460); color: #c9a84c; border: none; padding: 5px 12px; border-radius: 6px; font-size: 13px; }
  .btn-edit:hover { background: #c9a84c; color: #1a1a2e; }
  .btn-delete { background: #dc3545; color: white; border: none; padding: 5px 12px; border-radius: 6px; font-size: 13px; }
  .btn-delete:hover { background: #c82333; color: white; }
  /* Delete Confirmation Modal */
  .delete-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; align-items:center; justify-content:center; }
  .delete-overlay.active { display:flex; }
  .delete-modal { background:#fff; border-radius:16px; padding:0; max-width:420px; width:90%; box-shadow:0 20px 60px rgba(0,0,0,0.3); overflow:hidden; animation:modalIn 0.3s ease; }
  @keyframes modalIn { from { transform:scale(0.8); opacity:0; } to { transform:scale(1); opacity:1; } }
  .delete-modal-header { background:linear-gradient(135deg,#dc3545,#c82333); padding:25px; text-align:center; }
  .delete-modal-header i { font-size:40px; color:#fff; margin-bottom:10px; }
  .delete-modal-header h5 { color:#fff; margin:0; font-family: 'Playfair Display', serif !important; font-size:22px; }
  .delete-modal-body { padding:25px; text-align:center; }
  .delete-modal-body p { color:#555; font-size:15px; margin-bottom:5px; }
  .delete-modal-body .name { font-weight:700; color:#1a1a2e; font-size:18px; }
  .delete-modal-actions { display:flex; gap:12px; padding:0 25px 25px; }
  .delete-modal-actions .btn-cancel { flex:1; background:#f0f0f0; color:#555; border:none; padding:12px; border-radius:10px; font-weight:600; font-size:14px; cursor:pointer; transition:all 0.3s; }
  .delete-modal-actions .btn-cancel:hover { background:#e0e0e0; }
  .delete-modal-actions .btn-confirm-delete { flex:1; background:linear-gradient(135deg,#dc3545,#c82333); color:#fff; border:none; padding:12px; border-radius:10px; font-weight:600; font-size:14px; cursor:pointer; transition:all 0.3s; text-decoration:none; display:flex; align-items:center; justify-content:center; }
  .delete-modal-actions .btn-confirm-delete:hover { background:linear-gradient(135deg,#c82333,#a71d2a); transform:translateY(-1px); box-shadow:0 4px 15px rgba(220,53,69,0.4); color:#fff; }
</style>

<div class="container-fluid" style="padding: 20px;">
  {% if messages %}
  {% for message in messages %}
  <div class="alert alert-{{ message.tags }}" style="border-radius:12px;border:none;background:linear-gradient(135deg,#d4edda,#c3e6cb);color:#155724;font-size:14px;padding:15px 18px;margin-bottom:20px;box-shadow:0 2px 10px rgba(0,0,0,0.08);">
    <i class="fas fa-check-circle mr-2"></i> {{ message }}
  </div>
  {% endfor %}
  {% endif %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="section-header mb-0" style="border-bottom:none;padding-bottom:0;"><i class="fas fa-user-md" style="color: #c9a84c;"></i> Doctors List</h3>
    <a href="{% url 'admin-doctor' %}" class="btn" style="background:linear-gradient(135deg,#1a1a2e,#0f3460);color:#fff;border-radius:25px;padding:10px 25px;font-weight:600;">
      <i class="fas fa-arrow-left mr-2"></i>Back to Doctor Management
    </a>
  </div>
  <div class="table-responsive">
    <table class="table table-hover" id="dev-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Photo</th>
          <th>Mobile</th>
          <th>Address</th>
          <th>Department</th>
          <th>Update</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        {% for d in doctors %}
        <tr>
          <td>{{d.get_name}}</td>
          <td>{% if d.profile_pic %}<img src="{% static d.profile_pic.url %}" alt="Profile" style="height:40px;width:40px;border-radius:50%;object-fit:cover;border:2px solid #c9a84c;" />{% else %}<div style="width:40px;height:40px;border-radius:50%;background:#0f3460;display:inline-flex;align-items:center;justify-content:center;"><i class="fas fa-user-md" style="color:#c9a84c;font-size:16px;"></i></div>{% endif %}</td>
          <td>{{d.mobile}}</td>
          <td>{{d.address}}</td>
          <td>{{d.department}}</td>
          <td><a class="btn btn-edit" href="{% url 'update-doctor' d.id %}"><i class="fas fa-edit"></i></a></td>
          <td><a class="btn btn-delete" href="#" onclick="showDeleteModal('{{d.get_name}}', '{% url 'delete-doctor-from-hospital' d.id %}')"><i class="fas fa-trash-alt"></i></a></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="delete-overlay" id="deleteOverlay">
  <div class="delete-modal">
    <div class="delete-modal-header">
      <i class="fas fa-exclamation-triangle"></i>
      <h5>Confirm Deletion</h5>
    </div>
    <div class="delete-modal-body">
      <p>Are you sure you want to delete</p>
      <p class="name" id="deleteName"></p>
      <p style="color:#999;font-size:13px;margin-top:8px;">This action cannot be undone.</p>
    </div>
    <div class="delete-modal-actions">
      <button class="btn-cancel" onclick="hideDeleteModal()"><i class="fas fa-times mr-1"></i> Cancel</button>
      <a class="btn-confirm-delete" id="deleteLink" href="#"><i class="fas fa-trash-alt mr-1"></i> Delete</a>
    </div>
  </div>
</div>

<script>
function showDeleteModal(name, url) {
  document.getElementById('deleteName').textContent = name;
  document.getElementById('deleteLink').href = url;
  document.getElementById('deleteOverlay').classList.add('active');
}
function hideDeleteModal() {
  document.getElementById('deleteOverlay').classList.remove('active');
}
document.getElementById('deleteOverlay').addEventListener('click', function(e) {
  if (e.target === this) hideDeleteModal();
});
</script>
{% endblock content %}
